<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Network 产品说明书查看器</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f4f7f9;
            color: #333;
        }

        header {
            background-color: #007bff;
            color: white;
            padding: 15px 20px;
            text-align: center;
            border-radius: 8px 8px 0 0;
            margin-bottom: 20px;
        }

        h1 {
            margin: 0;
            font-size: 2em;
        }

        h2 {
            border-bottom: 2px solid #ddd;
            padding-bottom: 5px;
            margin-top: 30px;
            color: #007bff;
        }

        h3 {
            color: #555;
            margin-top: 20px;
        }

        .container {
            max-width: 900px;
            margin: auto;
            background-color: white;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }

        .input-area {
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: flex-end;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            min-width: 150px;
        }

        .input-group label {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9em;
            color: #555;
        }

        .input-area input[type="text"] {
            padding: 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 1em;
        }

        .input-area button {
            padding: 8px 20px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s;
        }

        .input-area button:hover {
            background-color: #218838;
        }

        .base-url {
            padding: 8px;
            border: 1px dashed #ccc;
            background-color: #f8f9fa;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9em;
            color: #666;
            align-self: flex-end;
        }

        .loading,
        .error {
            text-align: center;
            padding: 20px;
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
            border-radius: 4px;
            margin-top: 20px;
            display: none;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
            border-color: #f5c6cb;
        }

        .product-info table,
        .specs-table,
        .package-list,
        .setup-steps,
        .faq-list,
        .warranty-info {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        .product-info table td:first-child,
        .specs-table td:first-child {
            font-weight: bold;
            width: 30%;
            background-color: #f8f9fa;
        }

        .product-info table td,
        .specs-table td {
            padding: 10px;
            border: 1px solid #eee;
            text-align: left;
        }

        .specs-table th {
            background-color: #007bff;
            color: white;
            padding: 10px;
            border: 1px solid #007bff;
        }

        .package-list {
            list-style: none;
            padding-left: 0;
        }

        .package-list li {
            background-color: #f8f9fa;
            margin-bottom: 5px;
            padding: 10px;
            border-left: 4px solid #007bff;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
        }

        .setup-steps li {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fff;
        }

        .setup-steps h4 {
            margin-top: 0;
            color: #28a745;
            border-bottom: 1px dashed #ddd;
            padding-bottom: 5px;
        }

        .faq-list details {
            border: 1px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
            background-color: #fff;
        }

        .faq-list summary {
            font-weight: bold;
            cursor: pointer;
            color: #007bff;
        }

        .faq-list p {
            margin-top: 10px;
            padding-left: 10px;
            border-left: 3px solid #ccc;
        }

        .safety-notes li {
            margin-bottom: 10px;
            color: #dc3545;
            font-weight: 500;
        }

        .image-gallery {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .image-gallery img {
            max-width: 100%;
            height: auto;
            border: 1px solid #ddd;
            border-radius: 4px;
            max-height: 200px;
            object-fit: cover;
        }
    </style>
</head>

<body>

    <header>
        <h1>AI Network 产品说明书查看器</h1>
    </header>

    <div class="container">
        <div class="input-area">
            <span class="base-url" id="base-url">https://manual.aisail.com.cn/manuals/</span>
            <div class="input-group">
                <label for="product-dir">产品目录 (e.g., an1001)</label>
                <input type="text" id="product-dir" placeholder="e.g., an1001" value="template">
            </div>
            <div class="input-group">
                <label for="data-file">文件名 (e.g., manual-an1001-zh-v1.0.0.json)</label>
                <input type="text" id="data-file" placeholder="e.g., data.json" value="data.json">
            </div>
            <button onclick="loadManual()">加载说明书</button>
        </div>

        <div id="loading" class="loading">正在加载数据...</div>
        <div id="error" class="error">加载失败。请检查路径和网络连接。</div>

        <div id="manual-content" style="display: none;">
            <section id="product-info-section">
                <h2>产品概览</h2>
                <div class="product-info">
                    <table>
                        <tr>
                            <td>产品 ID</td>
                            <td id="product-id"></td>
                        </tr>
                        <tr>
                            <td>产品名称</td>
                            <td id="product-name"></td>
                        </tr>
                        <tr>
                            <td>产品型号</td>
                            <td id="product-model"></td>
                        </tr>
                        <tr>
                            <td>品牌</td>
                            <td id="product-brand"></td>
                        </tr>
                        <tr>
                            <td>类别</td>
                            <td id="product-category"></td>
                        </tr>
                        <tr>
                            <td>发布日期</td>
                            <td id="product-release-date"></td>
                        </tr>
                        <tr>
                            <td>文档版本</td>
                            <td id="doc-version"></td>
                        </tr>
                        <tr>
                            <td>文档语言</td>
                            <td id="doc-lang"></td>
                        </tr>
                        <tr>
                            <td>最近更新</td>
                            <td id="doc-last-updated"></td>
                        </tr>
                        <tr>
                            <td>文档作者</td>
                            <td id="doc-author"></td>
                        </tr>
                    </table>
                </div>
                <h3>简介</h3>
                <p id="overview-description"></p>

                <h3>主要特性</h3>
                <ul id="overview-features"></ul>

                <h3>产品图片</h3>
                <div class="image-gallery" id="overview-images"></div>
            </section>

            <section id="specifications-section">
                <h2>技术规格</h2>
                <table class="specs-table">
                    <thead>
                        <tr>
                            <th colspan="2">硬件</th>
                        </tr>
                    </thead>
                    <tbody id="specs-hardware"></tbody>
                    <thead>
                        <tr>
                            <th colspan="2">无线参数</th>
                        </tr>
                    </thead>
                    <tbody id="specs-wireless"></tbody>
                    <thead>
                        <tr>
                            <th colspan="2">电源信息</th>
                        </tr>
                    </thead>
                    <tbody id="specs-power"></tbody>
                    <thead>
                        <tr>
                            <th colspan="2">物理参数</th>
                        </tr>
                    </thead>
                    <tbody id="specs-dimensions"></tbody>
                </table>
            </section>

            <section id="package-contents-section">
                <h2>包装清单</h2>
                <ul class="package-list" id="package-contents-list"></ul>
            </section>

            <section id="setup-instructions-section">
                <h2>安装步骤</h2>
                <ol class="setup-steps" id="setup-instructions-list"></ol>
            </section>

            <section id="safety-notes-section">
                <h2>安全注意事项</h2>
                <ul id="safety-notes-list"></ul>
            </section>

            <section id="faq-section">
                <h2>常见问题 (FAQ)</h2>
                <div class="faq-list" id="faq-list"></div>
            </section>

            <section id="warranty-section">
                <h2>保修与售后</h2>
                <div class="warranty-info">
                    <p><strong>保修期 (月):</strong> <span id="warranty-period"></span></p>
                    <h3>保修政策</h3>
                    <p id="warranty-policy"></p>
                    <h3>联系方式</h3>
                    <ul id="warranty-contact"></ul>
                </div>
            </section>

            <section id="extra-resources-section">
                <h2>附加资源</h2>
                <ul id="extra-resources-list"></ul>
            </section>

        </div>
    </div>

    <script>
        const BASE_URL = 'https://manual.aisail.com.cn/manuals/';
        const lang = 'zh'; // 默认显示语言

        function $(id) {
            return document.getElementById(id);
        }

        function displayElement(id, display) {
            $(id).style.display = display;
        }

        function getLocalized(data, key) {
            if (typeof data === 'object' && data !== null && data[lang]) {
                return data[lang];
            }
            // 尝试返回第一个键值作为备用
            if (typeof data === 'object' && data !== null) {
                return data[Object.keys(data)[0]] || key;
            }
            return data || 'N/A';
        }

        async function loadManual() {
            const productDir = $('product-dir').value.trim();
            const dataFile = $('data-file').value.trim();

            // 隐藏内容和错误/加载提示
            displayElement('manual-content', 'none');
            displayElement('error', 'none');
            displayElement('loading', 'block');

            if (!productDir || !dataFile) {
                displayElement('loading', 'none');
                $('error').innerHTML = '错误：产品目录和文件名都不能为空。';
                displayElement('error', 'block');
                return;
            }

            const fullUrl = `${BASE_URL}${productDir}/${dataFile}`;

            try {
                const response = await fetch(fullUrl);
                if (!response.ok) {
                    throw new Error(`HTTP 错误！状态: ${response.status}`);
                }
                const data = await response.json();
                renderManual(data);
                displayElement('loading', 'none');
                displayElement('manual-content', 'block');
            } catch (e) {
                console.error('加载 JSON 数据失败:', e);
                displayElement('loading', 'none');
                $('error').innerHTML = `加载数据失败: ${e.message}<br>尝试的 URL: <a href="${fullUrl}" target="_blank">${fullUrl}</a>`;
                displayElement('error', 'block');
            }
        }

        function renderManual(data) {
            // 根字段
            $('doc-version').textContent = data.version || 'N/A';

            // --- 产品基本信息 (product) ---
            if (data.product) {
                $('product-id').textContent = data.product.id || 'N/A';
                $('product-name').textContent = getLocalized(data.product.name, '产品名称');
                $('product-model').textContent = data.product.model || 'N/A';
                $('product-brand').textContent = data.product.brand || 'N/A';
                $('product-category').textContent = data.product.category || 'N/A';
                $('product-release-date').textContent = data.product.release_date || 'N/A';
            }

            // --- 文档元信息 (meta) ---
            if (data.meta) {
                $('doc-lang').textContent = data.meta.language || 'N/A';
                $('doc-last-updated').textContent = data.meta.last_updated ? new Date(data.meta.last_updated).toLocaleString() : 'N/A';
                $('doc-author').textContent = data.meta.author || 'N/A';
            }

            // --- 产品概览 (overview) ---
            if (data.overview) {
                $('overview-description').textContent = getLocalized(data.overview.description, '暂无简介');

                const featuresList = $('overview-features');
                featuresList.innerHTML = '';
                if (Array.isArray(data.overview.features)) {
                    data.overview.features.forEach(feature => {
                        const li = document.createElement('li');
                        li.textContent = feature;
                        featuresList.appendChild(li);
                    });
                }

                const imageGallery = $('overview-images');
                imageGallery.innerHTML = '';
                if (Array.isArray(data.overview.images)) {
                    data.overview.images.forEach(url => {
                        const img = document.createElement('img');
                        img.src = url;
                        img.alt = getLocalized(data.product.name, '产品图片');
                        imageGallery.appendChild(img);
                    });
                }
            }

            // --- 技术规格 (specifications) ---
            renderSpecifications(data.specifications);

            // --- 包装清单 (package_contents) ---
            const packageList = $('package-contents-list');
            packageList.innerHTML = '';
            if (Array.isArray(data.package_contents)) {
                data.package_contents.forEach(item => {
                    const li = document.createElement('li');
                    li.innerHTML = `<span>${item.item || 'N/A'}</span><span>x ${item.quantity || 1}</span>`;
                    packageList.appendChild(li);
                });
            }

            // --- 安装步骤 (setup_instructions) ---
            const setupList = $('setup-instructions-list');
            setupList.innerHTML = '';
            if (Array.isArray(data.setup_instructions)) {
                // 确保按 step 排序
                data.setup_instructions.sort((a, b) => (a.step || 0) - (b.step || 0));
                data.setup_instructions.forEach(step => {
                    const li = document.createElement('li');
                    let html = `<h4>步骤 ${step.step || 'N/A'}: ${step.title || '无标题'}</h4>`;
                    html += `<p>${step.description || '无详细描述。'}</p>`;
                    if (step.image) {
                        html += `<img src="${step.image}" alt="步骤图示" style="max-width: 100%; margin-top: 10px; border: 1px solid #eee; border-radius: 4px;">`;
                    }
                    li.innerHTML = html;
                    setupList.appendChild(li);
                });
            }

            // --- 安全注意事项 (safety_notes) ---
            const safetyList = $('safety-notes-list');
            safetyList.innerHTML = '';
            if (Array.isArray(data.safety_notes)) {
                data.safety_notes.forEach(note => {
                    const li = document.createElement('li');
                    li.textContent = note;
                    safetyList.appendChild(li);
                });
            }

            // --- 常见问题 (faq) ---
            const faqList = $('faq-list');
            faqList.innerHTML = '';
            if (Array.isArray(data.faq)) {
                data.faq.forEach(item => {
                    const details = document.createElement('details');
                    const summary = document.createElement('summary');
                    summary.textContent = item.question || 'N/A';
                    const answer = document.createElement('p');
                    answer.textContent = item.answer || 'N/A';
                    details.appendChild(summary);
                    details.appendChild(answer);
                    faqList.appendChild(details);
                });
            }

            // --- 保修与售后 (warranty) ---
            if (data.warranty) {
                $('warranty-period').textContent = (data.warranty.period_months ? `${data.warranty.period_months} 个月` : 'N/A');
                $('warranty-policy').textContent = data.warranty.policy || 'N/A';

                const contactList = $('warranty-contact');
                contactList.innerHTML = '';
                if (data.warranty.contact) {
                    const contact = data.warranty.contact;
                    if (contact.phone) contactList.innerHTML += `<li>电话: <a href="tel:${contact.phone}">${contact.phone}</a></li>`;
                    if (contact.email) contactList.innerHTML += `<li>邮箱: <a href="mailto:${contact.email}">${contact.email}</a></li>`;
                    if (contact.website) contactList.innerHTML += `<li>网址: <a href="${contact.website}" target="_blank">${contact.website}</a></li>`;
                }
            }

            // --- 附加资源 (extra_resources) ---
            const resourcesList = $('extra-resources-list');
            resourcesList.innerHTML = '';
            if (data.extra_resources) {
                const resources = data.extra_resources;
                if (resources.pdf_manual_url) resourcesList.innerHTML += `<li><a href="${resources.pdf_manual_url}" target="_blank">PDF 说明书下载</a></li>`;
                if (resources.firmware_download_url) resourcesList.innerHTML += `<li><a href="${resources.firmware_download_url}" target="_blank">固件下载</a></li>`;
                if (resources.support_forum) resourcesList.innerHTML += `<li><a href="${resources.support_forum}" target="_blank">支持社区/论坛</a></li>`;
            }
        }

        function renderSpecifications(specs) {
            if (!specs) return;

            // 渲染表格行的辅助函数
            function appendRow(tbodyId, label, value) {
                const tbody = $(tbodyId);
                const tr = document.createElement('tr');
                tr.innerHTML = `<td>${label}</td><td>${value}</td>`;
                tbody.appendChild(tr);
            }

            // 清空所有规格表
            $('specs-hardware').innerHTML = '';
            $('specs-wireless').innerHTML = '';
            $('specs-power').innerHTML = '';
            $('specs-dimensions').innerHTML = '';

            // 硬件
            if (specs.hardware) {
                appendRow('specs-hardware', 'CPU', specs.hardware.cpu || 'N/A');
                appendRow('specs-hardware', '内存 (RAM)', specs.hardware.ram || 'N/A');
                appendRow('specs-hardware', '存储 (ROM)', specs.hardware.rom || 'N/A');

                if (Array.isArray(specs.hardware.ports)) {
                    const portsInfo = specs.hardware.ports.map(p =>
                        `${p.type || ''}${p.speed ? ` (${p.speed})` : ''} x ${p.quantity || 1}`
                    ).join(', ');
                    appendRow('specs-hardware', '接口信息', portsInfo || 'N/A');
                } else {
                    appendRow('specs-hardware', '接口信息', 'N/A');
                }
            }

            // 无线
            if (specs.wireless) {
                if (Array.isArray(specs.wireless.standards)) {
                    appendRow('specs-wireless', '无线标准', specs.wireless.standards.join(', ') || 'N/A');
                }

                if (Array.isArray(specs.wireless.bands)) {
                    const bandsInfo = specs.wireless.bands.map(b =>
                        `${b.frequency || ''} ${b.speed ? `(${b.speed})` : ''}`
                    ).join(' / ');
                    appendRow('specs-wireless', '频段/速率', bandsInfo || 'N/A');
                }
            }

            // 电源
            if (specs.power) {
                appendRow('specs-power', '供电输入', specs.power.input || 'N/A');
                appendRow('specs-power', '功耗', specs.power.consumption || 'N/A');
            }

            // 尺寸
            if (specs.dimensions) {
                const dim = specs.dimensions;
                const dimStr = `宽 ${dim.width_mm || '?'} x 高 ${dim.height_mm || '?'} x 深 ${dim.depth_mm || '?'} mm`;
                appendRow('specs-dimensions', '尺寸 (长x宽x高)', dimStr);
            }
            appendRow('specs-dimensions', '重量 (g)', specs.weight_g ? `${specs.weight_g} g` : 'N/A');
        }

        // 页面加载完成后自动加载一次默认值
        window.onload = loadManual;
    </script>

</body>

</html>